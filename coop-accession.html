<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>조합원가입 안내 및 신청 | 전국장애인나눔협동조합</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;800&display=swap" rel="stylesheet">
  <style>
    :root{--brand:#4b4b8f;--brand-dark:#352f74;--muted:#6c757d;--bg:#f3f3f3}
    body{font-family:'Noto Sans KR',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:#fff;color:#222}
    .topbar{font-size:12px;background:#f8f9fa;border-bottom:1px solid #e9ecef}
    .navbar-brand img{height:44px}
    .brand-title{font-weight:800;color:var(--brand-dark);font-size:1.95rem;letter-spacing:-.2px}
    @media (max-width: 576px){.brand-title{display:none}}
    .mainnav{border-bottom:1px solid #e9ecef}
    .mainnav .nav-link{font-weight:600;color:#333}
    .mainnav .nav-link:hover{color:var(--brand)}
    .footer{background:#2d2142;color:#d9d6e5}
    .footer a{color:#e3def2;text-decoration:none}
    .footer a:hover{text-decoration:underline}
    .footer-brand img{height:36px}
    .sponsor-card{transition:transform 0.3s ease,box-shadow 0.3s ease}
    .sponsor-card:hover{transform:translateY(-5px);box-shadow:0 8px 20px rgba(0,0,0,0.15)!important}
    .highlight-box{background:linear-gradient(135deg,#e3f2fd 0%,#f0f7ff 100%);border-left:4px solid #4b4b8f;padding:1.5rem;border-radius:0.5rem}
    .account-info-box{background:#f8f9fa;border:2px solid #4b4b8f;border-radius:0.75rem;padding:1.5rem}
    .form-section{background:#fff;border-radius:0.75rem;box-shadow:0 2px 10px rgba(0,0,0,0.08)}
    .icon-circle{width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin-bottom:1rem}
  </style>
</head>
<body>
  <!-- Topbar -->
  <div class="topbar" style="font-size:12px;background:#f8f9fa;border-bottom:1px solid #e9ecef">
    <div class="container d-flex justify-content-end align-items-center gap-3 py-1">
      <div id="userInfo" style="display:none;">
        <span id="usernameDisplay" class="text-muted me-2"></span>
        <form action="/coop/logout" method="post" style="display:inline;">
          <button type="submit" class="btn btn-link link-secondary p-0" style="text-decoration:none;">로그아웃</button>
        </form>
      </div>
      <div id="guestInfo">
        <a href="coop-login.html" class="link-secondary">로그인</a>
        <a href="coop-register.html" class="link-secondary">회원가입</a>
      </div>
    </div>
  </div>
  <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center gap-3" href="nanum.html">
        <img src="img/나눔logo.png" alt="전국장애인나눔협동조합 로고" style="height:44px" />
        <span class="fw-bold" style="color:#352f74;font-size:1.6rem;letter-spacing:-.2px">전국장애인나눔협동조합</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav" aria-controls="nav" aria-expanded="false" aria-label="토글 내비게이션">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="nav">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0 align-items-center">
          <li class="nav-item"><a class="nav-link" href="coop-housing.html">주거협동조합</a></li>
          <li class="nav-item"><a class="nav-link" href="coop-solar.html">태양광</a></li>
          <li class="nav-item"><a class="nav-link active" href="coop-board.html">게시판</a></li>
          <li class="nav-item ms-2">
            <a class="nav-link p-0" href="index.html" title="관악구장애인단체연합회 홈" style="display:inline-flex;align-items:center">
              <img src="img/footer-logo.png" alt="관악구장애인단체연합회 로고" style="height:32px" />
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <main class="container my-5">
    <!-- 페이지 헤더 -->
    <section class="page-header text-center mb-5">
      <div class="header-decoration mb-3">
        <i class="bi bi-house-fill display-6 text-danger"></i>
      </div>
      <h2 class="display-8 fw-bold text-dark mb-3">조합원가입 안내 및 신청</h2> 
      <p class="lead text-muted">전국장애인나눔협동조합의 조합원이 되어 다양한 사업과 활동에 참여하세요.</p>
    </section>

    <!-- 조합원가입 안내 섹션 -->
    <section class="mb-5">
      <div class="card border-0 shadow-lg">
        <div class="card-body p-5">
          <div class="row align-items-center mb-4">
            <div class="col-lg-8">
              <div class="section-badge mb-3">
                <span class="badge bg-danger bg-opacity-10 text-danger px-3 py-2 rounded-pill">
                  <i class="bi bi-info-circle me-1"></i> 조합원가입 안내
                </span>
              </div>
              <h3 class="display-6 fw-bold text-dark mb-4">조합원가입 안내 및 신청</h3>
              <p class="lead text-muted mb-4">
                아래 조합원가입 안내 및 신청 방법과 절차를 확인하시고, 많은 관심과 참여 부탁드립니다.
              </p>
            </div>
            <div class="col-lg-4 text-center">
              <div class="icon-circle bg-danger bg-opacity-10 text-danger mx-auto">
                <i class="bi bi-house"></i>
              </div>
            </div>
          </div>

          <div class="highlight-box mb-4">
            <h5 class="fw-bold text-primary mb-3"><i class="bi bi-check-circle-fill me-2"></i>조합원가입 안내 및 신청 방법과 절차</h5>
            <div class="row g-3">
              <div class="col-md-4">
                <div class="d-flex align-items-center">
                  <i class="bi bi-check-lg text-success me-2"></i>
                  <span>1. 가입 안내 및 홍보</span>
                </div>
              </div>
              <div class="col-md-4">
                <div class="d-flex align-items-center">
                  <i class="bi bi-check-lg text-success me-2"></i>
                  <span>2. 가입 신청</span>
                </div>
              </div>
              <div class="col-md-4">
                <div class="d-flex align-items-center">
                  <i class="bi bi-check-lg text-success me-2"></i>
                  <span>3. 자격 심사</span>
                </div>
              </div>
              <div class="col-md-4">
                <div class="d-flex align-items-center">
                  <i class="bi bi-check-lg text-success me-2"></i>
                  <span>4. 가입 승인</span>
                </div>
              </div>
            </div>
          </div>

          <!-- 주택 협동조합의 특징 카드 -->
          <div class="row g-4 mt-3">
            <div class="col-lg-6 col-md-6">
              <div class="sponsor-card card border-0 shadow h-100">
                <div class="card-body p-4">
                  <div class="d-flex align-items-center mb-3">
                    <div class="icon-circle bg-primary bg-opacity-10 text-primary me-3">
                      <i class="bi bi-house-check"></i>
                    </div>
                    <h4 class="fw-bold text-primary mb-0">주택 협동조합의 특징</h4>
                  </div>
                  <p class="text-muted mb-2">공동 소유 또는 공동 관리</p>
                  <p class="text-muted mb-0">비영리성</p>
                  <p class="text-muted mb-0">민주적 운영</p>
                </div>
              </div>
            </div>
            <div class="col-lg-6 col-md-6">
              <div class="sponsor-card card border-0 shadow h-100">
                <div class="card-body p-4">
                  <div class="d-flex align-items-center mb-3">
                    <div class="icon-circle bg-success bg-opacity-10 text-success me-3">
                      <i class="bi bi-house-check"></i>
                    </div>
                    <h4 class="fw-bold text-success mb-0">주택 협동조합의 설립 절차</h4>
                  </div>
                  <p class="text-muted mb-2">발기인 모집</p>
                  <p class="text-muted mb-2">정관 작성</p>
                  <p class="text-muted mb-2">설립동의자 모집</p>
                  <p class="text-muted mb-2">창립총회 개최</p>
                  <p class="text-muted mb-2">설립 신고</p>
                  <p class="text-muted mb-2">설립 등기</p>
                </div>
              </div>
            </div>
            <div class="col-lg-6 col-md-6">
              <div class="sponsor-card card border-0 shadow h-100">
                <div class="card-body p-4">
                  <div class="d-flex align-items-center mb-3">
                    <div class="icon-circle bg-info bg-opacity-10 text-info me-3">
                      <i class="bi bi-house-check"></i>
                    </div>
                    <h4 class="fw-bold text-info mb-0">장점</h4>
                  </div>
                  <p class="text-muted mb-2">저렴한 주택 마련련</p>
                  <p class="text-muted mb-2">공동체 형성</p>
                  <p class="text-muted mb-2">수요 맞춤형 주택</p>
                </div>
              </div>
            </div>
            <div class="col-lg-6 col-md-6">
              <div class="sponsor-card card border-0 shadow h-100">
                <div class="card-body p-4">
                  <div class="d-flex align-items-center mb-3">
                    <div class="icon-circle bg-warning bg-opacity-10 text-warning me-3">
                      <i class="bi bi-house-check"></i>
                    </div>
                    <h4 class="fw-bold text-warning mb-0">단점</h4>
                  </div>
                  <p class="text-muted mb-0">사업 추진의 어려움</p>
                  <p class="text-muted mb-0">전문성 부족</p>
                </div>
              </div>
            </div>
          </div>

          <!-- 필요서류 카드 -->
          <div class="card border-0 shadow mt-4" style="background: linear-gradient(135deg, #fff5f5 0%, #ffe8e8 100%);">
            <div class="card-body p-4">
              <h5 class="fw-bold text-danger mb-3"><i class="bi bi-file-earmark-text me-2"></i>필요서류</h5>
              <div class="row g-3">
                <div class="col-md-6">
                  <div class="d-flex align-items-start">
                    <i class="bi bi-person-check text-danger me-2 mt-1"></i>
                    <div>
                      <strong>개인:</strong>
                      <p class="mb-0 small text-muted">주민등록번호를 포함한 개인정보</p>
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="d-flex align-items-start">
                    <i class="bi bi-building text-danger me-2 mt-1"></i>
                    <div>
                      <strong>법인:</strong>
                      <p class="mb-0 small text-muted">사업자등록증 사본</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="alert alert-info mt-3 mb-0">
                <i class="bi bi-info-circle me-2"></i>
                <small>주택 협동조합 설립 신청 시 필요한 서류입니다.</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 후원 신청 폼 섹션 -->
    <section class="mb-5">
      <div class="card border-0 shadow-lg form-section">
        <div class="card-header border-0 rounded-top-4 py-4" style="background: linear-gradient(135deg, #a8c5f0 0%, #b8d4f5 100%); color: #2c3e50;">
          <div class="text-center">
            <i class="bi bi-pencil-square fs-3 mb-2"></i>
            <h3 class="mb-0 fw-bold">조합원 가입 신청서</h3>
          </div>
        </div>
        <div class="card-body p-5">
          <p class="text-muted text-center mb-4">
            아래 신청서를 작성해 주시면 담당자가 확인 후 연락을 드립니다.
          </p>

          <form id="accessionForm" method="post" enctype="multipart/form-data">
            <div class="row g-3">
              <div class="col-md-6">
                <label for="name" class="form-label">성함 <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="name" name="name" required placeholder="예: 홍길동">
              </div>
              <div class="col-md-6">
                <label for="birthdate" class="form-label">생년월일 <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="birthdate" name="birthdate" required placeholder="예: 19741207 또는 741207" maxlength="8">
              </div>
              <div class="col-md-6">
                <label for="phone" class="form-label">연락처 <span class="text-danger">*</span></label>
                <input type="tel" class="form-control" id="phone" name="phone" required placeholder="예: 010-1234-5678">
              </div>
              <div class="col-md-6">
                <label for="address" class="form-label">주소 <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="address" name="address" required placeholder="예: 서울특별시 관악구 신림동 123-45">
              </div>
              <div class="col-md-6">
                <label for="email" class="form-label">이메일 <span class="text-danger">*</span></label>
                <input type="email" class="form-control" id="email" name="email" required placeholder="예: example@email.com">
              </div>
              <div class="col-md-6">
                <label for="disabilityType" class="form-label">장애유형 및 등급 <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="disabilityType" name="disabilityType" required placeholder="예: 지체장애 2급">
              </div>
              <div class="col-12">
                <label for="documents" class="form-label">첨부 서류 및 자료 <span class="text-muted small">(이미지 파일 업로드 가능)</span></label>
                <input type="file" class="form-control" id="documents" name="documents" accept="image/*,.pdf" multiple>
                <div class="form-text">조합에서 요구하는 서류를 이미지 또는 PDF 파일로 업로드해주세요. (여러 파일 선택 가능)</div>
                <div id="filePreview" class="mt-2"></div>
              </div>
              <div class="col-12">
                <label for="message" class="form-label">추가 메모</label>
                <textarea class="form-control" id="message" name="message" rows="4" placeholder="추가로 전달하고 싶은 내용이 있으시면 입력해주세요."></textarea>
              </div>
            </div>

            <div class="d-flex gap-2 justify-content-end mt-4">
              <button type="reset" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-clockwise me-1"></i>초기화
              </button>
              <button type="submit" class="btn btn-primary">
                <i class="bi bi-send me-1"></i>신청하기
              </button>
            </div>
          </form>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="footer pt-4 pb-5 mt-0">
    <div class="container">
      <div class="row g-3">
        <div class="col-12 col-lg-8">
          <a class="footer-brand d-inline-flex align-items-center gap-2 mb-2" href="nanum.html">
            <img src="img/나눔logo.png" alt="전국장애인나눔협동조합 로고" />
            <span class="fw-bold text-white">전국장애인나눔협동조합</span>
          </a>
          <div class="small text-secondary">고유번호:119-86-87663 | 대표: 송 낙 규</div>
          <div class="small text-secondary">감사: 유 금 형 , 강 성 채 | 고문: 이 재 식 | 이사: 유 병 필</div>
          <div class="small text-secondary">서울특별시 남부순환로 1696, 뉴명지빌딩 (5,6,7층) | 전화 02-871-5686 | FAX 02-3281-3702</div>
          <div class="small text-secondary">Copyright &copy; 2025 관악구장애인단체연합회. All Rights Reserved.</div>
        </div>
        <div class="col-12 col-lg-4">
          <div class="d-flex gap-3 justify-content-lg-end small">
            <a href="terms.html">이용약관</a>
            <a href="privacy.html">개인정보처리방침</a>
            <a href="email-policy.html">이메일무단수집거부</a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    function copyAccount() {
      const account = '1005-003-466557';
      navigator.clipboard.writeText(account).then(function() {
        alert('계좌번호가 클립보드에 복사되었습니다: ' + account);
      }, function() {
        alert('복사에 실패했습니다. 수동으로 복사해주세요: ' + account);
      });
    }

    // 파일 미리보기
    document.getElementById('documents').addEventListener('change', function(e) {
      const preview = document.getElementById('filePreview');
      preview.innerHTML = '';
      
      if (this.files.length > 0) {
        const fileList = document.createElement('div');
        fileList.className = 'small text-muted';
        fileList.innerHTML = '<strong>선택된 파일:</strong><ul class="mb-0 mt-1">';
        
        Array.from(this.files).forEach((file, index) => {
          const listItem = document.createElement('li');
          listItem.textContent = `${index + 1}. ${file.name} (${(file.size / 1024).toFixed(2)} KB)`;
          fileList.querySelector('ul').appendChild(listItem);
        });
        
        fileList.innerHTML += '</ul>';
        preview.appendChild(fileList);
      }
    });

    // 조합원 가입 신청 폼 제출
    document.getElementById('accessionForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      // 필수 항목 검증
      const name = document.getElementById('name').value.trim();
      const birthdate = document.getElementById('birthdate').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const address = document.getElementById('address').value.trim();
      const email = document.getElementById('email').value.trim();
      const disabilityType = document.getElementById('disabilityType').value.trim();
      
      if (!name || !birthdate || !phone || !address || !email || !disabilityType) {
        alert('필수 항목을 모두 입력해주세요.\n\n필수 항목: 성함, 생년월일, 연락처, 주소, 이메일, 장애유형 및 등급');
        return;
      }

      const formData = new FormData(this);
      const submitBtn = this.querySelector('button[type="submit"]');
      const originalText = submitBtn.innerHTML;
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-1"></span>처리 중...';

      try {
        const response = await fetch('/coop/accession', {
          method: 'POST',
          body: formData
        });

        const result = await response.json();

        if (response.ok && result.success) {
          alert('조합원 가입 신청이 완료되었습니다.\n담당자가 확인 후 연락을 드리겠습니다. 감사합니다!');
          this.reset();
          document.getElementById('filePreview').innerHTML = '';
        } else {
          alert(result.error || '신청 중 오류가 발생했습니다.');
        }
      } catch (error) {
        console.error('Error:', error);
        alert('신청 중 오류가 발생했습니다. 다시 시도해주세요.');
      } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalText;
      }
    });
    
    // 로그인 상태 확인
    (async function(){
      try{
        const res=await fetch('/api/coop/user',{credentials:'include'});
        const data=await res.json();
        const userInfo=document.getElementById('userInfo');
        const guestInfo=document.getElementById('guestInfo');
        if(data.loggedIn){
          if(userInfo) userInfo.style.display='block';
          if(guestInfo) guestInfo.style.display='none';
          const nameEl=document.getElementById('usernameDisplay');
          if(nameEl) nameEl.textContent=`${data.username}님`;
        } else {
          if(userInfo) userInfo.style.display='none';
          if(guestInfo) guestInfo.style.display='block';
        }
      }catch(e){console.error('Error checking login status:',e)}
    })();
  </script>
</body>
</html>
